{% extends "base.html" %}

{% block title %}AI Career Analysis - Depanku{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/ai_analysis.css') }}">
{% endblock %}

{% block content %}
<main class="container">
    <div class="ai-analysis-container">
        <div class="analysis-header">
            <h1>AI Career Analysis</h1>
            <p>Get personalized recommendations from a team of AI experts.</p>
        </div>

        <div class="limit-warning" id="limit-warning">
            <strong>Free Tier Limit:</strong> You have <span id="remaining-analyses">3</span> AI analyses remaining.
        </div>
        <div class="error-message" id="error-message"></div>

        <div class="analysis-steps">
            <div class="step-connector"></div>
            <div class="step active" id="step-1">
                <div class="step-number">1</div>
                <div class="step-label">Refine Goal</div>
            </div>
            <div class="step" id="step-2">
                <div class="step-number">2</div>
                <div class="step-label">AI Debate</div>
            </div>
            <div class="step" id="step-3">
                <div class="step-number">3</div>
                <div class="step-label">Results</div>
            </div>
        </div>

        <div class="analysis-content" id="socratic-phase">
            <h3>Tell us your initial goal</h3>
            <p>We'll ask a few clarifying questions to understand exactly what you're looking for.</p>
            <div class="socratic-chat" id="chat-container">
                <div class="message ai-message">What are you hoping to achieve or discover?</div>
            </div>
            <div class="input-group" id="initial-goal-phase">
                <input type="text" id="goal-input" placeholder="e.g., 'Find a summer STEM internship'"
                    autocomplete="off">
                <button id="start-analysis-btn" class="btn btn-primary">Start</button>
            </div>
            <div class="input-group" id="question-phase" style="display: none;">
                <input type="text" id="answer-input" placeholder="Your response..." autocomplete="off">
                <button id="submit-answer-btn" class="btn btn-primary">Send</button>
            </div>
        </div>

        <div class="analysis-content debate-visualization" id="debate-phase">
            <h3>AI Experts are Debating Your Opportunity</h3>
            <p>Our team of AI specialists is analyzing your goals from different perspectives to build the best
                recommendation.</p>
            <div class="loading-spinner" style="width: 40px; height: 40px; margin-bottom: 1rem;"></div>
            <p id="debate-status">Building consensus among experts...</p>
            <div class="ai-personas">
                <!-- Persona cards will be updated by JS -->
            </div>
        </div>
    </div>
</main>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/ai_analysis.js') }}"></script>
{% endblock %}