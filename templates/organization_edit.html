{% extends "base.html" %}

{% block title %}Edit Organization - Depanku{% endblock %}

{% block content %}
<main class="form-page container">
    <div id="loading-container" class="text-center py-5">
        <div class="loading-spinner"></div>
        <p class="mt-3 text-muted">Loading organization data...</p>
    </div>

    <div id="form-container" style="display: none;">
        <h1 id="form-title" class="section-title"></h1>
        <p class="text-center text-muted" style="max-width: 600px; margin: -1rem auto 2.5rem;">
            Update the details for your organization. Changes will be re-submitted for review.
        </p>

        <div id="moderationErrorAlert" class="alert alert-danger" style="display: none;">
            <h4 id="moderationErrorSummary" class="mb-2"></h4>
            <div id="moderationErrorDetails"></div>
        </div>
        <div id="generalErrorAlert" class="alert alert-danger" style="display: none;"></div>

        <form id="organizationForm" novalidate>
            {% include '_organization_form_fields.html' %}

            <div class="d-flex justify-content-end gap-2 mt-4">
                <a href="{{ url_for('organizations.organization_view_page', org_id=org_id) }}"
                    class="btn btn-outline">Cancel</a>
                <button type="submit" class="btn btn-primary" id="submitBtn"></button>
            </div>
        </form>
    </div>
</main>

<template id="positionTemplate">
    <div class="position-card">
        <button type="button" class="btn-close remove-position" aria-label="Remove position"></button>
        <h5 class="mb-3">Position #<span class="position-number">1</span></h5>
        <div class="mb-2"><input type="text" class="form-control position-title"
                placeholder="Position Title * (e.g., Software Engineering Intern)"></div>
        <div class="mb-2"><textarea class="form-control position-description" rows="2"
                placeholder="Position description"></textarea></div>
        <div class="mb-2"><input type="text" class="form-control position-requirements"
                placeholder="Requirements (comma-separated)"></div>
        <div class="mb-2"><input type="url" class="form-control position-link" placeholder="Direct application link">
        </div>
    </div>
</template>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/organization_form.js') }}"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const orgId = '{{ org_id }}';
        initializeFormForEdit(orgId);
    });
</script>
{% endblock %}